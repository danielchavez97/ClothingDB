{% import "_macros.html" as macros %}
{% include 'head.html' %}
{% include 'messages.html' %}

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-tagsinput/1.3.6/jquery.tagsinput.min.js"></script>

<script type="text/javascript">
  $(document).ready(function(){
    $("#add_to_wantlist").click(function(){
      $.ajax({
        type: 'POST',
        contentType: 'application/json',
        data: "{{item.id}}",
        dataType: 'json',
        url: "{{url_for('main.add_to_wantlist', id=item.id)}}",
        success: function () {
          $("#add_to_wantlist").text("Remove from Wantlist");
          $("#add_to_wantlist").addClass('btn-danger').removeClass('btn-primary');
          $("#add_to_wantlist").attr('id', 'remove_from_wantlist')
          location.reload();
        }
      });
    });
    $("#remove_from_wantlist").click(function(){
      $.ajax({
        type: 'POST',
        contentType: 'application/json',
        data: "{{item.id}}",
        dataType: 'json',
        url: "{{url_for('main.remove_from_wantlist', id=item.id)}}",
        success: function () {
          $("#remove_from_wantlist").text("Add to Wantlist");
          $("#remove_from_wantlist").addClass('btn-primary').removeClass('btn-danger');
          $("#remove_from_wantlist").attr('id', 'add_to_wantlist')
          location.reload();
        }
      });
    });
    $("#add_to_collection").click(function(){
      $.ajax({
        type: 'POST',
        contentType: 'application/json',
        data: "{{item.id}}",
        dataType: 'json',
        url: "{{url_for('main.add_to_collection', id=item.id)}}",
        success: function () {
          $("#add_to_collection").text("Remove from Collection");
          $("#add_to_collection").addClass('btn-danger').removeClass('btn-primary');
          $("#add_to_collection").attr('id', 'remove_from_collection')
          location.reload();
        }
      });
    });
    $("#remove_from_collection").click(function(){
      $.ajax({
        type: 'POST',
        contentType: 'application/json',
        data: "{{item.id}}",
        dataType: 'json',
        url: "{{url_for('main.remove_from_collection', id=item.id)}}",
        success: function () {
          $("#remove_from_collection").text("Add to Collection");
          $("#remove_from_collection").addClass('btn-primary').removeClass('btn-danger');
          $("#remove_from_wantlist").attr('id', 'add_to_collection')
          location.reload();
        }
      });
    });
  });
</script>






<div class="container">
  <div class="row mb-50">
    <div class="col">
      <div id="carouselExampleControls" class="carousel slide" style="width: 447; height: 468">
        <div class="carousel-inner">
          {% if item.thumbnails.all()|length > 1%}
          <div class="carousel-item active">
            <img class="d-block w-100" src={{"https://d2x1mfjcaooqwx.cloudfront.net/" ~ item.thumbnails.first().filename}}>
          </div>
          {% for entry in item.thumbnails.all()[1:] %}
          <div class="carousel-item">
            <img class="d-block w-100" src={{"https://d2x1mfjcaooqwx.cloudfront.net/" ~ entry.filename}}>
          </div>
          {% endfor %}
          {% else %}
          <div class="carousel-item active">
            <img class="product-img" src={{"https://d2x1mfjcaooqwx.cloudfront.net/" ~ item.thumbnails.first().filename}}>
          </div>
          {% endif %}
        </div>
        <a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev">
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
          <span class="sr-only">Previous</span>
        </a>
        <a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next">
          <span class="carousel-control-next-icon" aria-hidden="true"></span>
          <span class="sr-only">Next</span>
        </a>
      </div>
    </div>
    <div class="col" style="border: 1.5px solid black; padding: 30px;">
      <div class="my-auto">
        <h1>{{item.brand_name}}</h1>
        <h2>{{item.name}}</h2>
        <br>
        <h5>Styles:</h5>
        <div>
          {% for style in item.styles %}
          <span class="badge badge-dark">{{style.name}}</span>
          {% endfor %}
        </div>
        <br>
        <h5>Year Released: {{item.date_released.year}}</h5>
        <br><br>
        <h5>Category: {{item.categories.name}}</h5>
        <h5>Subcategory: {{item.subcategories.name}}</h5>
        <br>
        {% if current_user.is_authenticated %}
        {% if item in current_user.wants.all() %}
        <button class="btn btn-danger" id="remove_from_wantlist">Remove from Wantlist</button>
        {% else %}
        <button class="btn btn-primary" id="add_to_wantlist">Add to Wantlist</button>
        {% endif %}

        {% if item in current_user.haves.all() %}
        <button class="btn btn-danger" id="remove_from_collection">Remove from Collection</button>
        {% else %}
        <button class="btn btn-primary" id="add_to_collection">Add to Collection</button>
        {% endif %}
        {% endif %}

      </div>
    </div>
  </div>
  <div class="row mb-50">
    <div class="accordion" id="accordionExample">
      <div class="card">
        <div class="card-header" id="headingOne">
          <h5 class="mb-0">
            <button class="btn" type="button" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne" >
              Description
            </button>
          </h5>
        </div>

        <div id="collapseOne" class="collapse show" aria-labelledby="headingOne" data-parent="#accordionExample">
          <div class="card-body">
            {{item.description}}
          </div>
        </div>
      </div>
      <div class="card">
        <div class="card-header" id="headingTwo">
          <h5 class="mb-0">
            <button class="btn collapsed" type="button" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
              Size & Fit
            </button>
          </h5>
        </div>
        <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordionExample">
          <div class="card-body">
            need to work on this one
          </div>
        </div>
      </div>
      <div class="card">
        <div class="card-header" id="headingThree">
          <h5 class="mb-0">
            <button class="btn collapsed" type="button" data-toggle="collapse" data-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
              Materials
            </button>
          </h5>
        </div>
        <div id="collapseThree" class="collapse" aria-labelledby="headingThree" data-parent="#accordionExample">
          <div class="card-body">
            {% for mat in item.materials.all() %}
            <li>{{mat.name}}</li>
            {% endfor %}
          </div>
        </div>
      </div>
    </div>
  </div>
</div>



